# insurance_rate（费率表识别平铺）

- 目标：将复杂的、多维度的保险费率数据转换为一种更易于理解、处理和分析的形式。
- 操作：费率表平铺，即把保险费率表格中所有情况的费率一条一条列出来。
- 用到大模型的几个地方：表格结构识别，表格内容分类匹配，因子字段映射内容匹配。

表格处理逻辑：
1. 用设计好的Table等类读取sheet内容。

2. 用大模型识别表格结构。识别每一行和每一列属于什么结构[main_title, row_title, content, additional_information]（行和列的识别规则有所不同）。

3. 用大模型对表格行标题，列标题和主标题进行因子匹配。识别出每个标题描述的内容属于哪个分类，所有的类别写在classifications_explanation中。

4. 对每个单元格合并各因子，平铺表格。把表格中识别为content的每个单元格的费率和因子的组合转换成一个list，并将其写入一个新的DataFrame，变量名为base_table，完成一个worksheet的处理。

5. 将处理完的这个sheet合并到base_table_dic（储存表格信息的主要变量）中，并暂时保存（用于检查bug）。

6. 因子字段映射。根据产品部门需求，将包含表格全部信息的base_table_dict中的因子字段名称进行映射（包括因子组合标题和内容），其中部分因子需要先用大模型对因子字段描述的类型进行识别。

操作流程：
1. 后端调用接口后，会在后台增加任务，完成后发送一条消息到callbackUrl。